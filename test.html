<div>
    <label for="exclude-keywords">Exclude:</label>
    <input type="text" id="exclude-keywords" placeholder="Enter keywords to exclude">
</div>
<div>
    <label for="search-input">Search:</label>
    <input type="text" id="search-input" placeholder="Search records">
</div>

<script>
    $(document).ready(function() {
        var table = $('#data-table').DataTable();

        // Handle the "exclude" input
        $('#exclude-keywords').on('keyup', function() {
            var excludeKeywords = this.value.split(',').map(keyword => keyword.trim());

            // Remove the existing filtering to apply the exclusion
            table.columns().every(function() {
                var column = this;
                column.search('').draw();
            });

            // Apply the exclusion filter
            excludeKeywords.forEach(keyword => {
                table.columns().every(function() {
                    var column = this;
                    column.search(`^(?!.*${keyword}).*$`, true, false).draw();
                });
            });
        });

        // Handle the default search input
        $('#search-input').on('keyup', function() {
            table.search(this.value).draw();
        });
    });
</script>





<!-- Add an input field for excluding keywords -->
<input type="text" id="exclude-keywords" placeholder="Exclude Keywords" />

<script>
$(document).ready(function() {
    var table = $('#data-table').DataTable({
        "pageLength": 20,
        "lengthMenu": [20, 40, 60, 100, 200, 400, 600],
        "stateSave": true
    });

    // Define an object to store the initial search state for each column
    var initialSearchState = {};

    // Enable column-wise filtering with unique values as checkboxes
    table.columns().every(function() {
        var column = this;
        var select = $('<select multiple="multiple"><option value=""></option></select>')
            .appendTo($(column.header()))
            .on('change', function() {
                var selectedValues = $.map($(this).find('option:selected'), function(option) {
                    return '^' + $.fn.dataTable.util.escapeRegex($(option).val()) + '$';
                });
                var searchValue = selectedValues.join('|');
                column.search(searchValue, true, false).draw();
            });

        column.data().unique().sort().each(function(d) {
            select.append('<option value="' + d + '">' + d + '</option>');
        });

        // Store the initial search state for this column
        initialSearchState[column.index()] = column.search();
    });

    $('#exclude-keywords').on('keyup', function() {
        var excludeKeywords = this.value.split(',').map(keyword => keyword.trim());

        table.columns().every(function() {
            var column = this;
            var columnIndex = column.index();

            // Revert to the initial search state for this column
            column.search(initialSearchState[columnIndex]).draw();

            // Apply the exclusion filter for each keyword
            excludeKeywords.forEach(keyword => {
                var searchValue = `^(?!.*${$.fn.dataTable.util.escapeRegex(keyword)}).*$`;
                column.search(searchValue, true, false);
            });
        });

        table.draw();
    });
});
</script>


