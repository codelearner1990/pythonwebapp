<script>
    $(document).ready(function() {
        var table = $('#data-table').DataTable();

        // Initialize search and exclude values
        var searchValue = '';
        var excludeValue = '';

        // Handle the built-in DataTables search bar
        table.on('search.dt', function() {
            searchValue = table.search();
            applySearchAndExcludeFilters();
        });

        // Handle the "exclude" input
        $('#exclude-keywords').on('keyup', function() {
            excludeValue = this.value;
            applySearchAndExcludeFilters();
        });

        // Function to apply both search and exclude filters
        function applySearchAndExcludeFilters() {
            // Create a combined regex for search and exclude
            var combinedRegex = `(${searchValue})^(?!.*(${excludeValue.split(',').map(keyword => keyword.trim()).join('|')})).*$`;
            table.search(combinedRegex, true, false).draw();
        }
    });
</script>
